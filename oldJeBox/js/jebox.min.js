/**
 @Name : jeBox v1.0 弹层组件
 @Author: chen guojun
 @Date: 2016-4-2
 @QQ群：516754269
 @官网：http://www.jayui.com/jebox/ 或 https://github.com/singod/jeBox
 */
!function(a,b){function e(a,d){var k,l,m,n,o,p,q,r,s,t,f=function(a,b){for(var c=0;c<a.length&&b(c,a[c])!==!1;c++);},g=function(a){return c.getElementById(a)},h=function(a,d){var e=d!=b?d:c,g=[],h=e.getElementsByTagName("*");return f(h,function(b,c){new RegExp("(\\s|^)"+a+"(\\s|$)").test(c.className)&&g.push(c)}),g},i=function(a,d){var l,m,n,o,e=d!=b?d:c,g=[],h=/\./.test(a),i=/\=/.test(a),j=i?a.match(/\w+\[([\w\-_][^=]+)=([\'\[\]\w\-_]+)\]/):a.split("."),k=e.getElementsByTagName(h?j[0]:j[0].split("[")[0]);return h&&j[1]!=b||i?(l=h?j[1]:j,m=/MSIE (6|7)/i.test(navigator.userAgent)?"className":"class",n=h?m:l[1],o=h?l:l[2],f(k,function(a,b){new RegExp(o).test(b.getAttribute(n))&&g.push(b)})):f(k,function(a,b){g.push(b)}),g},j=this.elements=[];if("string"==typeof a)if(a=a.replace(/(^\s*)|(\s*$)/g,""),k=/\s+/g,l=/\>/.test(a)?a.replace(/([ \t\r\n\v\f])*>([ \t\r\n\v\f])*/g,">").replace(/\>/g," ").replace(k," "):a.replace(k," "),m=/^\#/,n=/^\./,/\,/.test(l))for(o=l.split(/,/g),p=o.length,q=0;p>q;++q)j=j.concat(e(o[q]));else/\s*/.test(l)?(r=l.split(" "),s=[],d=[],f(r,function(a,b){0==d.length&&d.push(c);var e=b.substring(1);s=[],m.test(b)?s.push(g(e)):n.test(b)?f(d,function(a,b){f(h(e,b),function(a,b){s.push(b)})}):f(d,function(a,c){f(i(b,c),function(a,b){s.push(b)})}),d=s}),j=s):(t=l.substring(1),m.test(l)?j.push(g(t)):j=n.test(l)?h(t):i(l));else"Object"==typeof l&&l!=b&&(j[0]=l);return j}function g(a,b){function c(a){return a.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()})}var d="width"===b?["left","right"]:["top","bottom"],e=a[0][c("offset-"+b)];return(0>=e||null==e)&&(e=parseFloat(a[0][c("client-"+b)])-parseFloat(a.css("padding-"+d[0])||0)-parseFloat(a.css("padding-"+d[1])||0)),e}var f,c=a.document;({}).toString,f=function(a,b){var c=new f.fn.init(a,b);return c},f.extend=function(){var d,a=function e(a,b){for(var c in a)if(a.hasOwnProperty(c)){if(a[c]instanceof Object&&b[c]instanceof Object&&e(a[c],b[c]),b.hasOwnProperty(c))continue;b[c]=a[c]}},b={},c=arguments;if(!c.length)return{};for(d=c.length-1;d>=0;d--)a(c[d],b);return c[0]=b,b},f.each=function(a,b){for(var c=0,d=a.length;d>c&&b(c,a[c])!==!1;c++);},f.isType=function(a,b){var c=b.replace(/\b(\w)|\s(\w)/g,function(a){return a.toUpperCase()});return Object.prototype.toString.call(a)==="[object "+c+"]"},f.inArray=function(a,b,c){var e,d=Array.prototype.indexOf;if(b){if(d)return d.call(b,a,c);for(e=b.length,c=c?0>c?Math.max(0,e+c):c:0;e>c;c++)if(c in b&&b[c]===a)return c}return-1},f.unique=function(a){var b=[],c=0,d=a.length;if(f.isType(a,"array"))for(;d>c;c++)-1===f.inArray(a[c],b)&&b.push(a[c]);return b},f.merge=function(a,c){var d=c.length,e=a.length,g=0;if(f.isType(d,"number"))for(;d>g;g++)a[e++]=c[g];else for(;c[g]!==b;)a[e++]=c[g++];return a.length=e,a},f.trim=function(a){return a.replace(/(^\s*)|(\s*$)/g,"")},f.fn=f.prototype={init:function(b,d){var g,h,i;if(!b)return this;if(b.nodeType)return this.node=this[0]=b,this.length=1,this;if(null!=b&&b==b.window)return this.context=this[0]=a,this.length=1,this;if("body"===b&&c.body)return this.node=c,this[0]=c.body,this.selector=b,this.length=1,this;if("string"==typeof b){for(d=d||c,g=e(b,d),h=[],i=0;i<g.length;i++)h.push(g[i]);return f(this).pushStack(h)}return this},find:function(a){return f(a,this)},size:function(){return this.length},each:function(a){return f.each(this,a),this},pushStack:function(a){for(var b=f(),c=0,d=a.length;d>c;c++)b[c]=a[c];return b.length=d,b},css:function(a,b){var f,g,d=this,e=arguments[0];return"string"==typeof a&&"string"==typeof b?d.each(function(c,d){d.style[a]=b}):"string"==typeof a&&"undefined"==typeof b?0==d.size()?null:(f=this[0],g=function(){var a=c.defaultView;return new Function("el","style",["style.indexOf('-')>-1 && (style=style.replace(/-(\\w)/g,function(m,a){return a.toUpperCase()}));","style=='float' && (style='",a?"cssFloat":"styleFloat","');return el.style[style] || ",a?"window.getComputedStyle(el, null)[style]":"el.currentStyle[style]"," || null;"].join(""))}(),g(f,a)):d.each(function(a,b){for(var c in e)b.style[c]=e[c]})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(/[\n\t\r]/g," ").indexOf(b)>-1)return!0;return!1},addClass:function(a){return this.hasClass(a)||(this[0].className=f.trim(this[0].className+" "+a+" ")),this},removeClass:function(a){var b=this[0];return a?this.hasClass(a)&&(b.className=f.trim((" "+b.className+" ").replace(" "+a+" "," "))):b.className="",this},contents:function(){for(var b=0,c=this.length,d=[];c>b;b++)d=f.merge(d,this[b].childNodes);return d=f.unique(d),this.pushStack(d)},position:function(){if(0==this.size())return null;var a=this[0];return{left:a.offsetLeft,top:a.offsetTop}},width:function(a){return a==b?g(this,"width"):(this.css("width","number"==typeof a?a+"px":a),this)},height:function(a){return a==b?g(this,"height"):(this.css("height","number"==typeof a?a+"px":a),this)},attr:function(a,c){var e,d=this[0];return"undefined"==typeof c?(d&&1===d.nodeType&&(e=d.getAttribute(a)),null==e?b:e):this.each(function(b,d){1===d.nodeType&&d.setAttribute(a,c)})},html:function(a){var c=this[0];return"undefined"==typeof a?c&&1===c.nodeType?c.innerHTML:b:"undefined"!=typeof a&&1==a?c&&1===c.nodeType?c.outerHTML:b:this.each(function(b,c){c.innerHTML=a})},text:function(a){var d=this[0],e=c.all?"innerText":"textContent";return"undefined"==typeof a?d&&1===d.nodeType?d[e]:b:this.each(function(b,c){c[e]=a})},val:function(a){var c=this[0];return"undefined"==typeof a?c&&1===c.nodeType&&"undefined"!=typeof c.value?c.value:b:(a=null==a?"":a+"",this.each(function(b,c){"undefined"!=typeof c.value&&(c.value=a)}))},bind:function(b,c){return this.each(function(d,e){e.attachEvent?e.attachEvent("on"+b,function(){c.call(e,a.type)}):e.addEventListener(b,c,!1)})}},f.fn.init.prototype=f.fn,a.JED=$D=f}(window),function(a,b,c){function p(a,b,c,d,e){b&&b.parentNode?b.parentNode.insertBefore(a,b.nextSibling):c&&c.parentNode?c.parentNode.insertBefore(a,c):d&&d.appendChild(a),a.style.display=e,this.backSitu=null}var l,m,n,o,e=document.body,f=document.documentElement,g={},h={},i=/\px|em/g;/msie 6/.test(navigator.userAgent.toLowerCase()),g.index=Math.floor(9e3*Math.random()),l=["jeBox",".jeBox-wrap",".jeBox-header",".jeBox-content",".jeBox-footer",".jeBox-close",".jeBox-maxbtn"],h.endfun={},m={cell:"",title:"提示信息",content:"暂无内容！",boxStyle:{},closeBtn:!0,maxBtn:!1,area:"auto",padding:"5px",offset:["auto","auto"],type:1,icon:0,button:[],yesfun:null,nofun:null,time:0,masklock:!0,maskClose:!1,maskColor:["#000",.5],isDrag:!0,fixed:!0,zIndex:9999,scrollbar:!0,shadow:!0,success:null,endfun:null},o=function(b){var c=this;c.config=a.extend(m,b||{}),c.index=""!=c.config.cell?c.config.cell:++g.index,n=c.config.content,c.initView()},o.prototype={initView:function(){var d,e,f,g,i,j,k,m,n,o,p,q,r,s,t,b=this,c=b.config;h.scrollbar=c.scrollbar,""!=c.cell&&a("#"+l[0]+b.index)[0]||(d=function(){var a=c.button?function(){var b,d,a=[];for("array"==typeof c.button&&(c.button=[c.button]),b=0;b<c.button.length;b++)d=c.button[b].hasOwnProperty("disabled")&&1==c.button[b].disabled?"disabled":"",a.push('<button type="button" class="jeBox-btn'+b+'" jebtn="'+b+'" '+d+">"+c.button[b].name+"</button>");return a.reverse().join("")}():"";return'<div class="jeBox-footer">'+a+"</div>"}(),e='<span class="jeBox-headbtn"><a href="javascript:;" class="jeBox-maxbtn"></a><a href="javascript:;" class="jeBox-close" title="&#20851;&#38381;">&times;</a></span><div class="jeBox-header"></div><div class="jeBox-content" style="padding:'+(""!=c.padding?c.padding:0)+';"></div>'+d,f=function(a){var b=0;for(z=0;z<a.length;z++)b=Math.max(b,a[z].style.zIndex);return b},g=a(l[1]),i=g[0]?f(g)+5:c.zIndex+5,j=g[0]?f(g)+2:c.zIndex,k=document.createElement("div"),m=document.createElement("div"),b.id=k.id=l[0]+b.index,k.className=l[1].replace(/\./g,""),k.style.position=c.fixed?"fixed":"absolute",k.style.zIndex=i,k.innerHTML=e,k.setAttribute("jeb",b.index),a("body")[0].appendChild(k),c.masklock&&(b.mask=m.id="jemask"+b.index,m.className="jeBox-mask",m.style.cssText="left:0;top:0;background-color:"+c.maskColor[0]+";z-index:"+j+";opacity:"+c.maskColor[1]+";filter:alpha(opacity="+100*c.maskColor[1]+");",a("body")[0].appendChild(m)),n="#"+b.id,o=0==c.title||"false"==c.title,p="object"==typeof c.title,q=p?c.title:[c.title,{}],r=""==c.btn&&null==c.btn,a(n+" "+l[2]).html(o?"":q[0]).css({display:o?"none":"",height:o?"0px":""}).css(q[1]),a(n+" "+l[4]).css({display:r?"none":"",height:r?"0px":""}),a(n+" "+l[5]).css("display",c.closeBtn?"":"none"),a(n+" "+l[6]).css("display",c.maxBtn?"":"none"),!c.scrollbar&&a("body").css("overflow","hidden"),b.content(c).layerSize(c).position(c).btnCallback(c),c.isDrag&&(s=a(n),t=a(n+" "+l[2]),b.dragLayer(s,t,.4,c.shadow)),setTimeout(function(){c.success&&c.success(a(n),b.index)},1))},content:function(b){var g,i,c=this,d=a("#"+c.id+" "+l[3]),e=b.content,f="object"==typeof e;switch(iconMsg='<div class="jeBox-iconbox jeicon'+b.icon+'">'+e+"</div>",b.type){case 1:"string"==typeof e?d.html(0!==b.icon?iconMsg:e):e&&1===e.nodeType&&(h.Dispy=e.style.display,h.Prev=e.previousSibling,h.Next=e.nextSibling,h.Parent=e.parentNode,g=document.createElement("div"),"none"==e.style.display&&(e.style.display="block"),d[0].appendChild(g.appendChild(e)));break;case 2:i=f?e:[e||"http://www.jayui.com/","auto"],d.html('<iframe scrolling="'+(i[1]||"auto")+'" allowtransparency="true" id="jeboxiframe'+c.index+'" name="'+c.index+'" onload="this.className=\'\';" frameborder="0" width="100%" height="100%" src="'+i[0]+'"></iframe>');break;case 3:d.html('<div class="jeBox-loadbox jeload'+b.icon+'">'+e+"</div>")}return c},layerSize:function(b){var j,k,m,n,v,w,x,y,c=this,d="",e="",g="#"+c.id,o=a(g+" "+l[3]),p=f.clientWidth,q=f.clientHeight,r=h.conhead=a(g+" "+l[2]).height(),s=h.confoot=a(g+" "+l[4]).height(),t=h.getPads(o,"padding-top")+h.getPads(o,"padding-bottom"),u=h.getPads(o,"padding-left")+h.getPads(o,"padding-right");return 1==b.area.length?(d=b.area,e=b.area):(d=b.area[0],e=b.area[1]),a.isType(b.area,"array")&&(a.isType(d,"number")?j=d:"auto"==d?j=m="auto":(v=/^\d+%$/.test(d.toString())?parseInt(p*(d.replace("%","")/100)):parseInt(d.replace(i,"")),w=v>=p?p:v,j=w+"px",m=w-u+"px")),a.isType(b.area,"array")&&(a.isType(e,"number")?k=e:"auto"==e?k=n="auto":(x=/^\d+%$/.test(e.toString())?parseInt(q*(e.replace("%","")/100)):parseInt(e.replace(i,"")),y=x>=q?q:x,k=y+"px",n=y-t-r-s+"px")),b.maxBtn&&a(g).attr("area",[j,k,m,n].toString().replace(i,"")),a(g).css({width:j,height:k}).css(b.boxStyle),a(g+" "+l[3]).css({width:m,height:n}),c},position:function(b){var e,g,c=this,d=a("#"+c.id),h=a.isType(b.offset,"array"),j=b.offset[0],k=b.offset[1],l=f.clientWidth,m=f.clientHeight,n=d.width(),o=d.height();return e=h&&/^\@/.test(j)?j.replace(/\@/g,""):"auto"==j?(m-o)/2+"px":/^\d+%$/.test(j)?j:j.replace(i,"")+"px",g=h&&/^\@/.test(k)?k.replace(/\@/g,""):"auto"==k?(l-n)/2+"px":/^\d+%$/.test(k)?k:k.replace(i,"")+"px",h&&(/^\@/.test(j)||/^\@/.test(k))?d.css({right:e,bottom:g}):d.css({top:e,left:g}),b.maxBtn&&d.attr("offset",[d.position().top,d.position().left]),c},btnCallback:function(b){function f(){var a=b.nofun&&b.nofun(c.index);a===!1||g.close(c.index)}var c=this,d="#"+c.id,e=a(d+" "+l[6]);return b.time<=0||setTimeout(function(){g.close(c.index)},1e3*b.time),b.closeBtn&&a(d+" "+l[5]).bind("click",f),b.maxBtn&&e.bind("click",function(){e.hasClass("revert")?(e.removeClass("revert"),g.restore(c.index)):(e.addClass("revert"),g.full(c.index))}),b.button&&a(d+" "+l[4]).find("button").bind("click",function(){var e=parseInt(a(this).attr("jebtn"));0===e&&(b.yesfun?b.yesfun(c.index,a(d)):g.close(c.index)),b.button.length>1&&(1===e?f():(b.button[e]["callback"]&&b.button[e]["callback"](c.index,a(d)),b.button[e]["callback"]||g.close(c.index)))}),b.maskClose&&a("#jemask"+c.index).bind("click",function(){g.close(c.index)}),a(window).bind("resize",function(){a.isType(b.offset,"array")&&(/^\@/.test(b.offset[0])||/^\@/.test(b.offset[1]))&&a(d).css({top:"",left:""}),c.layerSize(b).position(b)}),b.endfun&&(h.endfun[c.index]=b.endfun),c},dragLayer:function(a,b,c,d){var g=this,h=!-[1];return b=b||a,g.tmpX=g.tmpY=0,g.isMoveable=!1,b[0].style.cursor="move",d?(g.isShadow=d?1==d||0==d?d:!1:!1,g.isShadow&&(g.opacity=c)):(g.opacity=100,g.isShadow=!1),g.tempLayer=document.createElement("div"),b[0].onmousedown=function(b){var b=b||window.event;return h&&1!=b.button||h&&0==b.button?!1:(g.isShadow&&(g.tempLayer.style.cssText="width : "+(a[0].offsetWidth-4)+"px;height : "+(a[0].offsetHeight-4)+"px;left : "+a[0].offsetLeft+"px;top : "+a[0].offsetTop+"px;opacity:"+g.opacity+";filter:alpha(opacity="+100*g.opacity+");z-Index : 29860813;",g.tempLayer.className="jeBox-moves",a[0].parentNode.appendChild(g.tempLayer)),g.isMoveable=!0,g.tmpX=b.clientX-a[0].offsetLeft,g.tmpY=b.clientY-a[0].offsetTop,b.preventDefault&&(b.preventDefault(),b.stopPropagation()),document.onmousemove=function(b){if(g.isMoveable){window.getSelection?window.getSelection().removeAllRanges():document.selection.empty();var b=b||window.event,c=g.isShadow?g.tempLayer:a,d=b.clientX-g.tmpX,e=b.clientY-g.tmpY,h=f.clientWidth-a[0].offsetWidth,i=f.clientHeight-a[0].offsetHeight;0>=d&&(d=0),0>=e&&(e=0),d>=h&&(d=h),e>=i&&(e=i),c.style.top=e+"px",c.style.left=d+"px"}},document.onmouseup=function(){g.isMoveable&&(g.isMoveable=!1,g.tmpX=g.tmpY=0,a.css({right:"",bottom:""}),g.isShadow&&(a.css({top:g.tempLayer.offsetTop+"px",left:g.tempLayer.offsetLeft+"px"}),e.removeChild(g.tempLayer)),f.clientWidth!=a[0].offsetWidth&&a.attr("offset",[a[0].offsetTop,a[0].offsetLeft]))},void 0)},g}},h.getPads=function(a,b){return parseInt(a.css(b).replace(i,""))},h.docSize=function(a){var b,c=["inner"+a],d=["client"+a];return window[c]?b=window[c]:e&&e[d]&&(b=e[d]),f&&f[d]&&(b=f[d]),b},g.open=function(a){var b=new o(a||{});return b.index},g.close=function(b){var c=a("#"+l[0]+b)[0],d=a("#jemask"+b)[0];c&&(n&&1===n.nodeType&&p(n,h.Prev,h.Next,h.Parent,h.Dispy),e.removeChild(c),d&&e.removeChild(d),"hidden"==a("body").css("overflow")&&a("body").css("overflow",""),"function"==typeof h.endfun[b]&&h.endfun[b](),delete h.endfun[b])},g.closeAll=function(){a(l[1]).each(function(a,b){g.close(b.getAttribute("jeb"))})},g.version="1.0",g.title=function(b,c){a("#"+l[0]+c+" "+l[2]).html(b)},g.content=function(b,c){a("#"+l[0]+c+" "+l[3]).html(b)},g.msg=function(b,c,d){var e="function"==typeof c;return e&&(d=c),g.open(a.extend({title:!1,content:b,padding:"10px",boxStyle:{background:"#fff",border:"1px solid #e3e3e3","border-radius":"4px",color:"#333",opacity:"0.93",filter:"alpha(opacity=90)"},time:3,masklock:!1,closeBtn:!1,end:d},!e&&function(){return c=c||{}}()))},g.alert=function(b,c,d){var e="function"==typeof c;return e&&(d=c),g.open(a.extend({content:b,yesfun:d,button:[{name:"确定"}]},e?{}:c))},g.loading=function(b,d,e){return g.open(a.extend({title:!1,closeBtn:!1,type:3,masklock:!1,content:d==c?"":d,icon:b||1,boxStyle:{background:"#fff",border:"1px solid #fff","border-radius":"4px",color:"#111",opacity:"0.93",filter:"alpha(opacity=90)"}},e))},g.restore=function(b){var c=a("#"+l[0]+b),d=a("#"+l[0]+b+" "+l[3]),e=c.attr("area").split(/,/g),f=c.attr("offset").split(/,/g);a("body").css("overflow",0==h.scrollbar?"hidden":""),c.css({width:e[0]+"px",height:e[1]+"px",top:f[0]+"px",left:f[1]+"px",right:"",bottom:""}),d.css({width:e[2]+"px",height:e[3]+"px"})},g.full=function(b){var c,d=a("#"+l[0]+b),e=a("#"+l[0]+b+" "+l[3]),f=h.getPads(d,"borderTopWidth")+h.getPads(d,"borderBottomWidth"),g=h.getPads(d,"borderLeftWidth")+h.getPads(d,"borderRightWidth"),i=h.getPads(e,"padding-top")+h.getPads(e,"padding-bottom"),j=h.getPads(e,"padding-left")+h.getPads(e,"padding-right");a("body").css("overflow","hidden"),clearTimeout(c),c=setTimeout(function(){a(d+" "+l[6]).addClass("revert");var b="fixed"===d.css("position"),c=d.attr("offset").split(/,/g),k=h.docSize("Width"),m=h.docSize("Height");d.css({width:k-f+"px",height:m-g+"px",top:b?0:c[0]+"px",left:b?0:c[1]+"px",right:"",bottom:""}),e.css({width:k-(j+f)+"px",height:m-(i+h.conhead+h.confoot+g)+"px"})},1)},g.getChildFrame=function(b,c){return c=c||$(".jeboxiframe").attr("jeb"),a("#"+l[0]+c).find("iframe").contents().find(b)},g.getFrameIndex=function(b){return a("#"+l[0]+b).attr("jeb")},g.iframeUrl=function(b,c){a("#"+l[0]+b).find("iframe").attr("src",c)},"function"==typeof define?define(function(){return g}):"object"==typeof module&&"object"==typeof module.exports?module.exports=g:window.jeBox=jeDialog=g}(window.$D,window);
